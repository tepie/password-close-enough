<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
</head>
<body>
<input type="text" name="original" />
<input type="text" name="attempt" />
<p id="close-enough"></p>
<script type="text/javascript">

function KeyboardCharacters(){
	this.boardStrings = undefined;
	this.boardArrays = undefined;
	this.buildBoards();
}

KeyboardCharacters.prototype.buildBoards = function (){
	this.boardStrings = new Array(new Array(), new Array(), new Array());
	this.boardsArrays = new Array(new Array(), new Array(), new Array());
	
	this.boardStrings[0] = "qwertyuiop";
	this.boardStrings[1] = "asdfghjkl";
	this.boardStrings[2] = "zxcvbnm";
	
	this.boardsArrays[0] = this.boardStrings[0].split("");
	this.boardsArrays[1] = this.boardStrings[1].split("");
	this.boardsArrays[2] = this.boardStrings[2].split("");
};

KeyboardCharacters.prototype.isAround = function(source,target){
	var sourceCords = this.getIndexOf(source);
	
	var check = undefined;
	try {	check 	= this.boardsArrays[sourceCords[0] - 1][sourceCords[1]]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0] + 1][sourceCords[1]]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0]][sourceCords[1] + 1]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0]][sourceCords[1] - 1]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0] - 1][sourceCords[1] + 1]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0] + 1][sourceCords[1] - 1]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0] - 1][sourceCords[1] - 1]; } catch (err) { }
	if( check == target) { return true; }
	try {	check 	= this.boardsArrays[sourceCords[0] + 1][sourceCords[1] + 1]; } catch (err) { }
	if( check == target) { return true; }
	
	return false;
};

KeyboardCharacters.prototype.getIndexOf = function(value){
	var returnResult = new Array();
	for(row=0; row<this.boardStrings.length; row++){
		var indexOfHere = this.boardStrings[row].indexOf(value);
		if( indexOfHere != -1){
			returnResult[0] = row;
			returnResult[1] = indexOfHere;
			break;
		}
	}
	
	return returnResult;
};

function KeyboardDigits(){
	KeyboardCharacters.call(this);
}

KeyboardDigits.prototype.buildBoards = function (){
	this.boardStrings = new Array(new Array());
	this.boardsArrays = new Array(new Array());
	
	this.boardStrings[0] = '1234567890';
	this.boardsArrays[0] = this.boardStrings[0].split("");
};

function PasswordCloseEnough(original,attempt){
	this.original = original;
	this.attempt = attempt;
	this.characterBoard = new KeyboardCharacters();
	this.wordPattern = /\w/;
	this.status = undefined;
}

PasswordCloseEnough.prototype.setup = function(){
	this.status = $('<div id="password-close-enough-status" />');
	this.status.appendTo($('body'));
	this.attempt.keyup( {callingReference: this}, this.eventCallback);
};

PasswordCloseEnough.prototype.eventCallback = function(e){
	if( e.data.callingReference.attempt.val().length == e.data.callingReference.original.val().length ){
	
	} else {
		var prependMe = $('<p class="close-enough">original and attempt lengths do not match</p>');
		prependMe.prependTo(e.data.callingReference.status);
	}
};

</script>
<script type="text/javascript">
$(document).ready(function () {
	var attempt = $('input[name="attempt"]');
	var original = $('input[name="original"]');
	
	var passwordCloseEnough = new PasswordCloseEnough(original,attempt);
	passwordCloseEnough.setup();
	
	/*var status = $("p#close-enough");
	var characterBoard = new KeyboardCharacters();
	var wordPattern = /\w/;
	
	attempt.keyup(function(){
		if($(this).val().length == original.val().length){
			status.text("");
			
			var originalArray = original.val().toLowerCase().split("");
			var attemptArray = $(this).val().toLowerCase().split("");
			var closeEnough = true;
			var cnt = 0;
			while(closeEnough && cnt < originalArray.length){
				if(originalArray[cnt] != attemptArray[cnt] 
					&& wordPattern.test(originalArray[cnt]) 
					&& wordPattern.test(attemptArray[cnt])
					&& !characterBoard.isAround(originalArray[cnt],attemptArray[cnt])) {
					closeEnough = false;
					break;
				}
				cnt++;
			}
			
			if(closeEnough){
				status.text("attempt and original are close enough");	
			} else {
				status.text("attempt and original are NOT close enough");	
			}
			
		} else {
			status.text("attempt and original lengths do not match");	
		}
	});
	*/
});
</script>
</body>
</html>